 $portRange=20..22; $ipAddress="192.168.0.112"; $portRange | ForEach-Object { $port=$_; $job = Start-Job -ScriptBlock { Test-NetConnection -ComputerName $args[0] -Port $args[1] | Select-Object -Property TcpTestSucceeded } -ArgumentList $ipAddress, $port; if ($job | Wait-Job -Timeout 10) { $result = Receive-Job -Job $job; if ($result.TcpTestSucceeded) { "Port $port is open" } } Remove-Job -Job $job } | Out-File -FilePath "result.txt" -Encoding UTF8
